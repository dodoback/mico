<!DOCTYPE html>
<html lang="ko">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ë¯¸ì½”íŒ€ | ì‘ì—…í˜„í™©</title>
  <meta name="description" content="í˜„ì¬ ì§„í–‰ ì¤‘ì¸ ë¡¤ ëŒ€ë¦¬ ë° ê°•ì˜ ì‘ì—…ì„ ì‹¤ì‹œê°„ìœ¼ë¡œ í™•ì¸í•˜ì„¸ìš”.">
  <meta name="keywords" content="ë¡¤ ëŒ€ë¦¬ í˜„í™©, ì‘ì—…í˜„í™©, ë¯¸ì½”íŒ€ ëŒ€ë¦¬ ìƒíƒœ, ì‹¤ì‹œê°„ ë¡¤ ëŒ€ë¦¬">
  <link rel="stylesheet" href="styles.css" />

</head>

<body>
  <header class="site-header">
    <a href="index.html" class="logo">ë¯¸ì½”íŒ€</a>
    <!-- í–„ë²„ê±° ë²„íŠ¼ -->
    <input type="checkbox" id="menu-toggle" />
    <label for="menu-toggle" class="hamburger">
      <span></span>
      <span></span>
      <span></span>
    </label>

    <!-- ë„¤ë¹„ê²Œì´ì…˜ -->
    <nav>
      <ul class="nav-links">
        <li><a href="lineup.html">ê¸°ì‚¬ ë¼ì¸ì—…</a></li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle">ê°€ê²©í‘œ</a>
          <ul class="dropdown-menu">
            <li><a href="price-delegation.html">ëŒ€ë¦¬ ê°€ê²©</a></li>
            <li><a href="price-duo.html">ë“€ì˜¤ ê°€ê²©</a></li>
            <li><a href="price-placement.html">ë°°ì¹˜ ê³ ì‚¬</a></li>
            <li><a href="price-coaching.html">1:1 ê°•ì˜</a></li>
            <li><a href="price-growth.html">ìœ¡ì„±</a></li>
            <li><a href="price-consulting.html">ê¸°íƒ€ì„œë¹„ìŠ¤</a></li>
          </ul>
        </li>
        <li><a href="certification.html">ì‘ì—…ì¸ì¦</a></li>
        <li><a href="progress.html">ì‘ì—…í˜„í™©</a></li>
        <li><a href="reviews.html">ê³ ê°í›„ê¸°</a></li>
        <li><a href="notice.html">ê³µì§€ì‚¬í•­</a></li>
      </ul>
    </nav>



    <script>
      document.addEventListener('DOMContentLoaded', () => {
        const toggle = document.querySelector('.dropdown-toggle');
        const menu = document.querySelector('.dropdown-menu');

        toggle.addEventListener('click', (e) => {
          e.preventDefault();
          menu.classList.toggle('open');
        });
      });
    </script>
    <a href="https://open.kakao.com/o/s4PrQ2oh" class="contact-btn" target="_blank" rel="noopener noreferrer">
      <img src="img/icons8-ì¹´ì¹´ì˜¤-í†¡-48.png" alt=""> ì¹´í†¡ìƒë‹´
    </a>
  </header>

  <script>
    document.addEventListener('DOMContentLoaded', function () {
      const dropdownToggle = document.querySelector('.dropdown-toggle');
      const dropdown = dropdownToggle.closest('.dropdown');

      dropdownToggle.addEventListener('click', function (e) {
        e.preventDefault();
        dropdown.classList.toggle('open');
      });

      document.addEventListener('click', function (e) {
        if (!dropdown.contains(e.target)) {
          dropdown.classList.remove('open');
        }
      });
    });
  </script>


  <style>
    /* ì œëª© í…ìŠ¤íŠ¸ ë§í¬ ìƒ‰ìƒ ë³€ê²½ (ë°ì€ íšŒìƒ‰ ì¶”ì²œ) */
    table a {
      color: #90c3f9;
      /* ëˆˆì— í¸í•œ ë°ì€ íšŒìƒ‰ */
      text-decoration: none;
      /* ë°‘ì¤„ ì œê±°(ì„ íƒì‚¬í•­) */
    }

    /* ë§ˆìš°ìŠ¤ë¥¼ ì˜¬ë ¸ì„ ë•Œ ë°ì•„ì§€ëŠ” íš¨ê³¼ */
    table a:hover {
      color: #b9c5d1;
      /* í°ìƒ‰ìœ¼ë¡œ ë³€ê²½ */
    }





    .modal {
      display: none;
      position: fixed;
      z-index: 9999;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      background-color: rgba(0, 0, 0, 0.75);

      /* ì¤‘ì•™ ì •ë ¬ */
      display: flex;
      justify-content: center;
      align-items: center;
    }

    /* ëª¨ë‹¬ */
    .modal {
      display: none;
      position: fixed;
      z-index: 999;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.8);
      justify-content: center;
      align-items: center;
      margin-top: 50px;
    }

    .modal-content {
      max-width: 80%;
      max-height: 80%;
      border-radius: 8px;
      position: relative;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
    }

    .modal-close {
      position: absolute;
      top: 20px;
      right: 30px;
      color: #fff;
      font-size: 32px;
      cursor: pointer;
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: scale(0.95);
      }

      to {
        opacity: 1;
        transform: scale(1);
      }
    }





    body {
      font-family: 'Noto Sans KR', sans-serif;
      margin: 0;
      padding: 0;
      background: white;
      /* ì „ì²´ ë°°ê²½ì€ ë¸”ë™ */
    }

    .progress-section {
      background: #111;
      /* ì„¹ì…˜ ë‚´ë¶€ë§Œ ì–´ë‘¡ê²Œ */
      color: #fff;
      padding: 40px 5vw;

    }

    .filters {
      display: flex;
      justify-content: flex-end;
      /* ğŸ‘‰ ì˜¤ë¥¸ìª½ ì •ë ¬ */
      align-items: center;
      gap: 10px;
      margin-bottom: 20px;
      flex-wrap: wrap;
    }

    .filters select,
    .filters input {
      padding: 8px 12px;
      border-radius: 4px;
      border: none;
    }

    .progress-table {
      width: 100%;
      border-collapse: collapse;
      background-color: #1c1c1c;
      border-radius: 8px;
      overflow: hidden;
    }

    .progress-table th,
    .progress-table td {
      text-align: left;
      padding: 14px 10px;
      border-bottom: 1px solid #2c2c2c;
    }

    .progress-table thead {
      background-color: #2a2a2a;
    }

    .progress-table thead th {
      color: #ffe600;
    }

    .badge {
      padding: 4px 10px;
      border-radius: 6px;
      font-size: 12px;
      font-weight: bold;
      display: inline-block;
    }

    .badge-progress {
      background-color: #ffe600;
      color: #111;
    }

    .badge-done {
      background-color: #444;
      color: #aaa;
    }

    .btn {
      padding: 4px 8px;
      font-size: 13px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      margin-right: 5px;
    }

    .btn-edit {
      background-color: #4caf50;
      color: white;
    }

    .btn-delete {
      background-color: #f44336;
      color: white;
    }

    .pagination {
      text-align: center;
      margin-top: 20px;
    }

    .pagination button {
      background-color: #1c1c1c;
      border: 1px solid #444;
      color: #fff;
      padding: 6px 12px;
      margin: 0 2px;
      border-radius: 4px;
      cursor: pointer;
    }

    .pagination button.active {
      background-color: #ffe600;
      color: #111;
    }

    .login-area {
      text-align: right;
      margin-bottom: 20px;
      position: relative;
      bottom: 50px;
      margin-top: 100px;
    }

    .login-area input[type="password"] {
      padding: 5px 10px;
      border-radius: 4px;
      border: none;
    }

    .login-area button {
      padding: 6px 10px;
      border: none;
      background-color: #ffe600;
      border-radius: 4px;
      margin-left: 6px;
      cursor: pointer;
    }
  </style>
  </head>

  <body>
    <section class="progress-section">
      <!-- âœ… login-area ìˆ˜ì • -->
      <div class="login-area" id="loginArea">
        <input type="email" id="adminEmail" placeholder="ì´ë©”ì¼" />
        <input type="password" id="adminPassword" placeholder="ë¹„ë°€ë²ˆí˜¸" />
        <button onclick="login()" id="loginBtn">ë¡œê·¸ì¸</button>
        <button onclick="logout()" id="logoutBtn" style="display: none;">ë¡œê·¸ì•„ì›ƒ</button>
      </div>



      <div class="filters">
        <select id="statusFilter" onchange="renderTable()">
          <option value="ì „ì²´">ìƒíƒœ ì „ì²´</option>
          <option value="ì§„í–‰ì¤‘">ì§„í–‰ì¤‘</option>
          <option value="ì‘ì—…ì™„ë£Œ">ì‘ì—…ì™„ë£Œ</option>
        </select>
        <select id="serviceFilter" onchange="renderTable()">
          <option value="ì „ì²´">ì„œë¹„ìŠ¤ ì „ì²´</option>
          <option value="ê°•ì˜">ê°•ì˜</option>
          <option value="ë“€ì˜¤">ë“€ì˜¤</option>
          <option value="ëŒ€ë¦¬">ëŒ€ë¦¬</option>
        </select>
        <input type="text" id="searchInput" placeholder="ì œëª© ê²€ìƒ‰..." oninput="renderTable()" />
      </div>

      <table class="progress-table">
        <thead>
          <tr>
            <th>ë²ˆí˜¸</th>
            <th>ìƒíƒœ</th>
            <th>ì œëª©</th>
            <th>ì‘ì„±ì</th>
            <th>ì‘ì„±ì¼</th>
            <th>ì¡°íšŒìˆ˜</th>
            <th>ê´€ë¦¬</th>
          </tr>
        </thead>
        <tbody id="progressBody"></tbody>
      </table>

      <div class="pagination" id="pagination"></div>
    </section>

    <!-- ìƒì„¸ë³´ê¸° ëª¨ë‹¬ -->
    <div id="imageModal" class="modal">
      <span class="modal-close" id="closeModal">&times;</span>
      <img class="modal-content" id="modalImage" src="img/ì–¸ë­í¬-ì´ë¯¸ì§€.png" alt="ìƒì„¸ ì´ë¯¸ì§€">
    </div>


    <script>
      const data = [
        {
          id: 506, status: "ì§„í–‰ì¤‘", service: "ëŒ€ë¦¬",
          title: "3ì›” 21ì¼ | 336ê±´ ì‘ì—…ì¤‘ | ë¯¸ë“œ ëŒ€ë¦¬ë­í¬ | ë§ˆìŠ¤í„° í‹°ì–´",
          author: "ë¯¸ì½”íŒ€", date: "2025-03-21", views: 17,
          image: "img/ì¼ë°˜.webp"
        },
        {
          id: 506, status: "ì§„í–‰ì¤‘", service: "ëŒ€ë¦¬",
          title: "3ì›” 21ì¼ | 336ê±´ ì‘ì—…ì¤‘ | ë¯¸ë“œ ëŒ€ë¦¬ë­í¬ | ë§ˆìŠ¤í„° í‹°ì–´",
          author: "ë¯¸ì½”íŒ€", date: "2025-03-21", views: 17,
          image: "img/ì¼ë°˜.webp"
        },
        {
          id: 506, status: "ì§„í–‰ì¤‘", service: "ëŒ€ë¦¬",
          title: "3ì›” 21ì¼ | 336ê±´ ì‘ì—…ì¤‘ | ë¯¸ë“œ ëŒ€ë¦¬ë­í¬ | ë§ˆìŠ¤í„° í‹°ì–´",
          author: "ë¯¸ì½”íŒ€", date: "2025-03-21", views: 17,
          image: "img/ì¼ë°˜.webp"
        },
        {
          id: 506, status: "ì§„í–‰ì¤‘", service: "ë“€ì˜¤",
          title: "3ì›” 21ì¼ | 336ê±´ ì‘ì—…ì¤‘ | ë¯¸ë“œ ëŒ€ë¦¬ë­í¬ | ë§ˆìŠ¤í„° í‹°ì–´",
          author: "ë¯¸ì½”íŒ€", date: "2025-03-21", views: 17,
          image: "img/ì¼ë°˜.webp"
        },
        {
          id: 506, status: "ì‘ì—…ì™„ë£Œ", service: "ëŒ€ë¦¬",
          title: "3ì›” 21ì¼ | 336ê±´ ì‘ì—…ì¤‘ | ë¯¸ë“œ ëŒ€ë¦¬ë­í¬ | ë§ˆìŠ¤í„° í‹°ì–´",
          author: "ë¯¸ì½”íŒ€", date: "2025-03-21", views: 17,
          image: "img/ì¼ë°˜.webp"
        },
        {
          id: 506, status: "ì§„í–‰ì¤‘", service: "ëŒ€ë¦¬",
          title: "3ì›” 21ì¼ | 336ê±´ ì‘ì—…ì¤‘ | ë¯¸ë“œ ëŒ€ë¦¬ë­í¬ | ë§ˆìŠ¤í„° í‹°ì–´",
          author: "ë¯¸ì½”íŒ€", date: "2025-03-21", views: 17,
          image: "img/ì¼ë°˜.webp"
        },
        {
          id: 506, status: "ì‘ì—…ì™„ë£Œ", service: "ë“€ì˜¤",
          title: "3ì›” 21ì¼ | 336ê±´ ì‘ì—…ì¤‘ | ë¯¸ë“œ ëŒ€ë¦¬ë­í¬ | ë§ˆìŠ¤í„° í‹°ì–´",
          author: "ë¯¸ì½”íŒ€", date: "2025-03-21", views: 17,
          image: "img/ì¼ë°˜.webp"
        },
        {
          id: 506, status: "ì§„í–‰ì¤‘", service: "ëŒ€ë¦¬",
          title: "3ì›” 21ì¼ | 336ê±´ ì‘ì—…ì¤‘ | ë¯¸ë“œ ëŒ€ë¦¬ë­í¬ | ë§ˆìŠ¤í„° í‹°ì–´",
          author: "ë¯¸ì½”íŒ€", date: "2025-03-21", views: 17,
          image: "img/ì¼ë°˜.webp"
        },
        {
          id: 506, status: "ì‘ì—…ì™„ë£Œ", service: "ê°•ì˜",
          title: "3ì›” 21ì¼ | 336ê±´ ì‘ì—…ì¤‘ | ë¯¸ë“œ ëŒ€ë¦¬ë­í¬ | ë§ˆìŠ¤í„° í‹°ì–´",
          author: "ë¯¸ì½”íŒ€", date: "2025-03-21", views: 17,
          image: "img/ì¼ë°˜.webp"
        },
        {
          id: 506, status: "ì§„í–‰ì¤‘", service: "ëŒ€ë¦¬",
          title: "3ì›” 21ì¼ | 336ê±´ ì‘ì—…ì¤‘ | ë¯¸ë“œ ëŒ€ë¦¬ë­í¬ | ë§ˆìŠ¤í„° í‹°ì–´",
          author: "ë¯¸ì½”íŒ€", date: "2025-03-21", views: 17,
          image: "img/ì¼ë°˜.webp"
        },
        {
          id: 506, status: "ì‘ì—…ì™„ë£Œ", service: "ê°•ì˜",
          title: "3ì›” 21ì¼ | 336ê±´ ì‘ì—…ì¤‘ | ë¯¸ë“œ ëŒ€ë¦¬ë­í¬ | ë§ˆìŠ¤í„° í‹°ì–´",
          author: "ë¯¸ì½”íŒ€", date: "2025-03-21", views: 17,
          image: "img/ì¼ë°˜.webp"
        },
        {
          id: 505, status: "ì‘ì—…ì™„ë£Œ", service: "ë“€ì˜¤",
          title: "3ì›” 20ì¼ | 350ê±´ ì™„ë£Œ | ë“€ì˜¤ ì •ê¸€ | ì±Œë¦°ì € í‹°ì–´",
          author: "ë¯¸ì½”íŒ€", date: "2025-03-20", views: 12,
          image: "img/ì¼ë°˜.webp"
        }
      ];

      let isAdmin = false;
      let currentPage = 1;
      const itemsPerPage = 10;



      function renderTable() {
        const statusFilter = document.getElementById('statusFilter').value;
        const serviceFilter = document.getElementById('serviceFilter').value;
        const search = document.getElementById('searchInput').value.toLowerCase();

        let filtered = data.filter(item => {
          return (
            (statusFilter === "ì „ì²´" || item.status === statusFilter) &&
            
            item.title.toLowerCase().includes(search)
          );
        });

        const tbody = document.getElementById('progressBody');
        tbody.innerHTML = '';

        const start = (currentPage - 1) * itemsPerPage;
        const paginated = filtered.slice(start, start + itemsPerPage);

        paginated.forEach(item => {
          const tr = document.createElement('tr');
          tr.innerHTML = `
        <td>${item.id}</td>
        <td><span class="badge ${item.status === 'ì§„í–‰ì¤‘' ? 'badge-progress' : 'badge-done'}">${item.status}</span></td>
        
        <td><a href="#" class="title-clickable" data-image="${item.image}">${item.title}</a></td>
        <td>${item.author}</td>
        <td>${item.date}</td>
        <td>${item.views}</td>
        <td>${isAdmin ? `<button class="btn btn-edit">ìˆ˜ì •</button><button class="btn btn-delete">ì‚­ì œ</button>` : ''}</td>
      `;
          tbody.appendChild(tr);
        });

        renderPagination(filtered.length);
      }

      function renderPagination(totalItems) {
        const totalPages = Math.ceil(totalItems / itemsPerPage);
        const pagination = document.getElementById('pagination');
        pagination.innerHTML = '';

        const prevBtn = document.createElement('button');
        prevBtn.textContent = 'â€¹ ì´ì „';
        prevBtn.disabled = currentPage === 1;
        prevBtn.onclick = () => {
          if (currentPage > 1) {
            currentPage--;
            renderTable();
          }
        };
        pagination.appendChild(prevBtn);

        for (let i = 1; i <= totalPages; i++) {
          const btn = document.createElement('button');
          btn.textContent = i;
          if (i === currentPage) btn.classList.add('active');
          btn.onclick = () => {
            currentPage = i;
            renderTable();
          };
          pagination.appendChild(btn);
        }

        const nextBtn = document.createElement('button');
        nextBtn.textContent = 'ë‹¤ìŒ â€º';
        nextBtn.disabled = currentPage === totalPages;
        nextBtn.onclick = () => {
          if (currentPage < totalPages) {
            currentPage++;
            renderTable();
          }
        };
        pagination.appendChild(nextBtn);
      }



      document.getElementById('closeModal').addEventListener('click', function () {
        document.getElementById('imageModal').style.display = "none";
      });

      window.addEventListener('click', function (e) {
        const modal = document.getElementById('imageModal');
        if (e.target === modal) {
          modal.style.display = "none";
        }
      });

      // âœ… ê´€ë¦¬ì ë²„íŠ¼ ì´ë²¤íŠ¸ ì—°ê²°
      document.getElementById('progressBody').addEventListener('click', function (e) {
        if (e.target.classList.contains('btn-edit')) {
          alert('ìˆ˜ì • ê¸°ëŠ¥ì€ ì•„ì§ êµ¬í˜„ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.');
        }

        if (e.target.classList.contains('btn-delete')) {
          const row = e.target.closest('tr');
          const id = parseInt(row.children[0].textContent);

          if (confirm('ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
            const index = data.findIndex(item => item.id === id);
            if (index !== -1) {
              data.splice(index, 1);
              renderTable();
            }
          }
        }
      });

      window.onload = () => {

      };

      function openModal(src) {
        const modal = document.getElementById('imageModal');
        const img = document.getElementById('modalImage');
        img.src = src;
        modal.style.display = 'flex';
      }

      function closeModal() {
        document.getElementById('imageModal').style.display = 'none';
      }


    </script>
    <footer class="happyteam-footer">
      <div class="footer-content">
        <img src="img/í–„ìŠ¤í„°.webp" alt="ë¯¸ì½”íŒ€ ë¡œê³ " class="footer-logo">
        <h2>ë¯¸ì½”íŒ€ê³¼ í•¨ê»˜ ìµœê³ ì˜ í”Œë ˆì´ë¥¼ ê²½í—˜í•˜ì„¸ìš”!</h2>
        <p>ì‹¤ë ¥ í–¥ìƒë¶€í„° ë“ ë“ í•œ ë“€ì˜¤ê¹Œì§€, ë¯¸ì½”íŒ€ì´ ì—¬ëŸ¬ë¶„ê³¼ í•¨ê»˜í•©ë‹ˆë‹¤.</p>
        <div class="footer-links">
          <a href="#">ì„œë¹„ìŠ¤ ì´ìš©ì•½ê´€</a> |
          <a href="#">ê°œì¸ì •ë³´ ì²˜ë¦¬ë°©ì¹¨</a> |
          <a href="#">ë¬¸ì˜í•˜ê¸°</a>
        </div>
        <p class="copyright">Â© 2024 MICO. All rights reserved.</p>
      </div>
    </footer>

    <script type="module">
      import { initializeApp } from "https://www.gstatic.com/firebasejs/11.5.0/firebase-app.js";
      import {
        getFirestore,
        collection,
        getDocs,
        addDoc,
        deleteDoc,
        doc,
        updateDoc
      } from "https://www.gstatic.com/firebasejs/11.5.0/firebase-firestore.js";
      import {
        getAuth,
        signInWithEmailAndPassword,
        onAuthStateChanged,
        signOut
      } from "https://www.gstatic.com/firebasejs/11.5.0/firebase-auth.js";

      const firebaseConfig = {
        apiKey: "AIzaSyBKrorhUNyv8q_Bekg5DJnkZgCW9kFfjjI",
        authDomain: "mico-test-3b006.firebaseapp.com",
        projectId: "mico-test-3b006",
        storageBucket: "mico-test-3b006.appspot.com",
        messagingSenderId: "282703834529",
        appId: "1:282703834529:web:31a65b83e1a351a3ba2fe0"
      };

      const app = initializeApp(firebaseConfig);
      const db = getFirestore(app);
      const auth = getAuth(app);
      const colRef = collection(db, "progress");

      let isAdmin = false;
      let progressData = [];
      let currentPage = 1;
      const itemsPerPage = 10;

      function updateLoginUI() {
        const loginBtn = document.querySelector('#loginArea button[onclick="login()"]');
        const logoutBtn = document.getElementById('logoutBtn');
        const emailInput = document.getElementById('adminEmail');
        const pwInput = document.getElementById('adminPassword');

        if (isAdmin) {
          loginBtn.style.display = 'none';
          logoutBtn.style.display = 'inline-block';
          emailInput.style.display = 'none';
          pwInput.style.display = 'none';
        } else {
          loginBtn.style.display = 'inline-block';
          logoutBtn.style.display = 'none';
          emailInput.style.display = 'inline-block';
          pwInput.style.display = 'inline-block';
        }
      }

      window.login = async function () {
        const email = document.getElementById('adminEmail').value;
        const pw = document.getElementById('adminPassword').value;

        try {
          const userCredential = await signInWithEmailAndPassword(auth, email, pw);
          const token = await userCredential.user.getIdTokenResult();

          if (token.claims.admin) {
            isAdmin = true;
            alert("âœ… ê´€ë¦¬ì ë¡œê·¸ì¸ ì„±ê³µ!");
          } else {
            isAdmin = false;
            alert("ğŸš« ê´€ë¦¬ì ê¶Œí•œì´ ì—†ìŠµë‹ˆë‹¤.");
          }

          updateLoginUI();
          renderTable();
        } catch (err) {
          alert("ë¡œê·¸ì¸ ì‹¤íŒ¨: " + err.message);
        }
      };

      window.logout = async function () {
        try {
          await signOut(auth);
          isAdmin = false;
          alert("ğŸ‘‹ ë¡œê·¸ì•„ì›ƒ ë˜ì—ˆìŠµë‹ˆë‹¤.");
          updateLoginUI();
          renderTable();
        } catch (err) {
          alert("ë¡œê·¸ì•„ì›ƒ ì‹¤íŒ¨: " + err.message);
        }
      };

      onAuthStateChanged(auth, async (user) => {
        if (user) {
          await user.getIdToken(true);
          const token = await user.getIdTokenResult();
          isAdmin = !!token.claims.admin;
        } else {
          isAdmin = false;
        }
        updateLoginUI();
        fetchProgressData();
      });

      async function fetchProgressData() {
        const snapshot = await getDocs(colRef);
        progressData = snapshot.docs.map(doc => ({ fid: doc.id, ...doc.data() }));
        renderTable();
      }

      document.getElementById('progressBody').addEventListener('click', async function (e) {
        const row = e.target.closest('tr');
        const fid = row?.dataset.fid;

        if (e.target.classList.contains('btn-delete')) {
          if (confirm('ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
            await deleteDoc(doc(db, "progress", fid));
            fetchProgressData();
          }
        }

        if (e.target.classList.contains('btn-edit')) {
          const titleCell = row.querySelector('.title');
          const newTitle = prompt("ìƒˆ ì œëª©ì„ ì…ë ¥í•˜ì„¸ìš”:", titleCell.textContent);
          if (newTitle) {
            await updateDoc(doc(db, "progress", fid), { title: newTitle });
            fetchProgressData();
          }
        }
      });

      window.renderTable = function () {
        const statusFilter = document.getElementById('statusFilter').value;
        const serviceFilter = document.getElementById('serviceFilter').value;
        const search = document.getElementById('searchInput').value.toLowerCase();
        const tbody = document.getElementById('progressBody');

        const filtered = progressData.filter(item => {
          return (
            (statusFilter === "ì „ì²´" || item.status === statusFilter) &&
            
            item.title.toLowerCase().includes(search)
          );
        });

        tbody.innerHTML = '';
        const start = (currentPage - 1) * itemsPerPage;
        const paginated = filtered.slice(start, start + itemsPerPage);

        paginated.forEach((item, idx) => {
          const tr = document.createElement('tr');
          tr.dataset.fid = item.fid;
          tr.innerHTML = `
  <td>${(currentPage - 1) * itemsPerPage + idx + 1}</td>
  <td><span class="badge ${item.status === 'ì§„í–‰ì¤‘' ? 'badge-progress' : 'badge-done'}">${item.status}</span></td>
  <td class="title"><a href="#" class="title-clickable" data-image="${item.image}">${item.title}</a></td>
  <td>${item.author}</td>
  <td>${item.date}</td>
  <td>${item.views}</td>
  <td>${isAdmin ? `<button class="btn btn-edit">ìˆ˜ì •</button><button class="btn btn-delete">ì‚­ì œ</button>` : ''}</td>
`;

          tbody.appendChild(tr);
        });

        renderPagination(filtered.length);
      };

      window.renderPagination = function (totalItems) {
        const totalPages = Math.ceil(totalItems / itemsPerPage);
        const pagination = document.getElementById('pagination');
        pagination.innerHTML = '';

        const prevBtn = document.createElement('button');
        prevBtn.textContent = 'â€¹ ì´ì „';
        prevBtn.disabled = currentPage === 1;
        prevBtn.onclick = () => {
          if (currentPage > 1) {
            currentPage--;
            renderTable();
          }
        };
        pagination.appendChild(prevBtn);

        for (let i = 1; i <= totalPages; i++) {
          const btn = document.createElement('button');
          btn.textContent = i;
          if (i === currentPage) btn.classList.add('active');
          btn.onclick = () => {
            currentPage = i;
            renderTable();
          };
          pagination.appendChild(btn);
        }

        const nextBtn = document.createElement('button');
        nextBtn.textContent = 'ë‹¤ìŒ â€º';
        nextBtn.disabled = currentPage === totalPages;
        nextBtn.onclick = () => {
          if (currentPage < totalPages) {
            currentPage++;
            renderTable();
          }
        };
        pagination.appendChild(nextBtn);
      };



      document.getElementById('closeModal').addEventListener('click', () => {
        document.getElementById('imageModal').style.display = "none";
      });

      window.addEventListener('click', function (e) {
        const modal = document.getElementById('imageModal');
        if (e.target === modal) {
          modal.style.display = "none";
        }
      });

      window.onload = () => {
        fetchProgressData();
      };
    </script>



  </body>

</html>